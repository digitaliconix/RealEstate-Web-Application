(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{DBDi:function(t,e,r){"use strict";r.r(e);var n=r("djKw"),a=r.n(n),i=r("IAPz"),o=r("+4WA"),s=r("3uf8"),c=r("cbbs"),l=r("e9yv"),u=r("WzGQ"),d=r("dQIy"),p=r("c34V"),m=r("Bc29"),h=r("VOL1"),f=r("uvMX"),v=r("hbd/"),b=r("sejE"),_=r("4cv3"),g=r("wWPa"),y=r("1w2d");function w(t){var e={add:"/api/units/create",edit:"/api/units/".concat(t.params.id,"/edit")};return e[t.meta.mode]||e.add}var x={mixins:[f.a],components:{XTagInput:g.a,Error:b.a,BCard:i.a,BCardText:o.a,BLink:s.a,BRow:c.a,BCol:l.a,BFormInput:u.a,BFormGroup:d.a,BFormCheckboxGroup:p.a,BFormTextarea:m.a,BButton:h.a},directives:{Ripple:_.a},data:function(){return{show:!1,resource:"/units",store:"/api/units",method:"POST",title:"Add",message:"New Unit Added",permissions:[]}},beforeRouteEnter:function(t,e,r){Object(v.b)(w(t)).then((function(t){r((function(e){return e.setData(t)}))}))},beforeRouteUpdate:function(t,e,r){var n=this;Object(v.b)(w(t)).then((function(t){n.setData(t),r()}))},methods:{setData:function(t){a.a.set(this.$data,"form",t.data.form),"edit"===this.$route.meta.mode&&(this.store="/api/units/".concat(this.$route.params.id,"?_method=PUT"),this.title="Edit",this.message="Unit has been updated"),this.show=!0},formSubmitted:function(){var t=this;this.submit(this.form,(function(e){t.success(),t.successfull(e)}))},successfull:function(t){this.$router.push("".concat(this.resource))},onProjectUpdate:function(t){a.a.set(this.$data.form,"project",t),a.a.set(this.$data.form,"project_id",t.id)},onBuildingUpdate:function(t){a.a.set(this.$data.form,"building",t),a.a.set(this.$data.form,"building_id",t.id)},onUnitTypeUpdate:function(t){a.a.set(this.$data.form,"unit_type",t),a.a.set(this.$data.form,"unit_type_id",t.id),a.a.set(this.$data.form,"area",t.area),a.a.set(this.$data.form,"unit_price",t.base_price),a.a.set(this.$data.form,"measurement_type",t.measurement_type),a.a.set(this.$data.form,"measurement_type_id",t.measurement_type.id)},onMeasurementTypeUpdate:function(t){a.a.set(this.$data.form,"measurement_type",t),a.a.set(this.$data.form,"measurement_type_id",t.id)},onUnitCategoryUpdate:function(t){a.a.set(this.$data.form,"unit_category",t),a.a.set(this.$data.form,"unit_category_id",t.id)},onProjectChargeTypeUpdate:function(t,e){for(var r=0;r<this.form.charges.length;r++)if(this.form.charges[r].project_charge_type_id==t.id)return this.$toast({component:y.a,props:{title:"Alert",icon:"BellIcon",text:"This option is already selected",variant:"danger"}}),0;a.a.set(this.$data.form.charges[e],"project_charge_type",t),a.a.set(this.$data.form.charges[e],"project_charge_type_id",t.id)},addCharges:function(){this.form.charges.push({project_charge_type:null,project_charge_type_id:null,price:0})},removeItem:function(t){this.form.charges.splice(t,1)}}},$=r("KHd+"),j=Object($.a)(x,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.show?r("div",[r("b-card",{attrs:{title:t.title+" Unit"}},[r("b-row",[r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Number","label-for":"mc-title"}},[r("b-form-input",{attrs:{id:"mc-title",placeholder:"Number"},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}}),t._v(" "),r("error",{attrs:{error:t.error.number}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Project","label-for":"mc-project-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/projects",value:t.form.project,column:"title",name:"title"},on:{input:t.onProjectUpdate}}),t._v(" "),r("error",{attrs:{error:t.error.project_id}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Building","label-for":"mc-building-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/buildings?project_id="+t.form.project_id,value:t.form.building,disabled:null==t.form.project_id,column:"title",name:"title"},on:{input:t.onBuildingUpdate}}),t._v(" "),r("error",{attrs:{error:t.error.building_id}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Unit Type","label-for":"mc-unit-type-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/unit_types?project_id="+t.form.project_id,value:t.form.unit_type,disabled:null==t.form.project_id,column:"title",name:"title"},on:{input:t.onUnitTypeUpdate}}),t._v(" "),r("error",{attrs:{error:t.error.unit_type_id}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Area","label-for":"mc-area"}},[r("b-form-input",{attrs:{type:"number",id:"mc-area",placeholder:"Area"},model:{value:t.form.area,callback:function(e){t.$set(t.form,"area",e)},expression:"form.area"}}),t._v(" "),r("error",{attrs:{error:t.error.area}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Measurement Type","label-for":"mc-measurement-type-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/measurement_types",value:t.form.measurement_type,column:"title",name:"title"},on:{input:t.onMeasurementTypeUpdate}}),t._v(" "),r("error",{attrs:{error:t.error.measurement_type_id}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Net Price","label-for":"mc-price"}},[r("b-form-input",{attrs:{type:"number",id:"mc-price",placeholder:"Net Price"},model:{value:t.form.unit_price,callback:function(e){t.$set(t.form,"unit_price",e)},expression:"form.unit_price"}}),t._v(" "),r("error",{attrs:{error:t.error.unit_price}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Unit Category","label-for":"mc-unit-category-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/unit_categories",value:t.form.unit_category,column:"title",name:"title"},on:{input:t.onUnitCategoryUpdate}}),t._v(" "),r("error",{attrs:{error:t.error.unit_category_id}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"6"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"my-2",attrs:{type:"submit",variant:"primary"},on:{click:t.addCharges}},[t._v("\n                    Add Charges\n                ")])],1)],1),t._v(" "),t.form.charges.length>0?[r("hr"),t._v(" "),r("b-row",[r("b-col",{attrs:{md:"6"}},[r("h3",[t._v("Charges")])])],1),t._v(" "),t._l(t.form.charges,(function(e,n){return r("b-row",{key:n},[r("b-col",{attrs:{md:"5"}},[r("b-form-group",{attrs:{label:"Charge Type","label-for":"mc-charge-type-id"}},[r("x-tag-input",{attrs:{resource:"/api/search/project_charge_types?project_id="+t.form.project_id,value:e.project_charge_type,disabled:null==t.form.project_id,column:"title",name:"title"},on:{input:function(e){return t.onProjectChargeTypeUpdate(e,n)}}}),t._v(" "),r("error",{attrs:{error:t.error["charges."+n+".project_charge_type_id"]}})],1)],1),t._v(" "),r("b-col",{attrs:{md:"5"}},[r("b-form-group",{attrs:{label:"Price","label-for":"mc-price-"+n}},[r("b-form-input",{attrs:{type:"number",id:"mc-price-"+n,placeholder:"Price"},model:{value:e.price,callback:function(r){t.$set(e,"price",r)},expression:"item.price"}}),t._v(" "),r("error",{attrs:{error:t.error["charges."+n+".price"]}})],1)],1),t._v(" "),r("b-col",{staticClass:"mb-50",attrs:{md:"2"}},[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(234, 84, 85, 0.15)",expression:"'rgba(234, 84, 85, 0.15)'",modifiers:{400:!0}}],staticClass:"mt-0 mt-md-2",attrs:{variant:"outline-danger"},on:{click:function(e){return t.removeItem(n)}}},[r("feather-icon",{staticClass:"mr-25",attrs:{icon:"XIcon"}})],1)],1)],1)}))]:t._e(),t._v(" "),r("b-row",[r("b-col",[r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(255, 255, 255, 0.15)",expression:"'rgba(255, 255, 255, 0.15)'",modifiers:{400:!0}}],staticClass:"mr-1",attrs:{type:"submit",variant:"primary"},on:{click:t.formSubmitted}},[t._v("\n                    Submit\n                ")]),t._v(" "),r("b-button",{directives:[{name:"ripple",rawName:"v-ripple.400",value:"rgba(186, 191, 199, 0.15)",expression:"'rgba(186, 191, 199, 0.15)'",modifiers:{400:!0}}],attrs:{type:"reset",variant:"outline-secondary",to:{path:"/units"}}},[t._v("\n                    Cancel\n                ")])],1)],1)],2)],1):t._e()}),[],!1,null,"73cf8b78",null);e.default=j.exports},f9f4:function(t,e,r){"use strict";function n(t,e,r){var a=e||new FormData;for(var i in t)if(t.hasOwnProperty(i)){var o=r?r+"["+i+"]":i;if(t[i]!==Object(t[i])||t[i]instanceof File)if(t[i]instanceof Array)for(var s=0;s<t[i].length;s++)n(t[i][s],a,"".concat(o,"[").concat(s,"]"));else{var c=null===t[i]?"":t[i];a.append(o,c)}else n(t[i],a,o)}return a}r.d(e,"a",(function(){return n}))},"hbd/":function(t,e,r){"use strict";r.d(e,"b",(function(){return i})),r.d(e,"c",(function(){return o})),r.d(e,"a",(function(){return s}));var n=r("Poqw"),a=r.n(n);r("f9f4");function i(t,e){return a()({method:"GET",url:t,params:e})}function o(t,e){return s("POST",t,e)}function s(t,e,r){return a()({method:t,url:e,data:r})}},sejE:function(t,e,r){"use strict";var n={props:{error:{type:Array,default:function(){return[]}}}},a=r("KHd+"),i=Object(a.a)(n,(function(){var t=this.$createElement,e=this._self._c||t;return this.error?e("small",{staticClass:"text-danger"},[this._v(this._s(this.error[0]))]):this._e()}),[],!1,null,null,null);e.a=i.exports},uvMX:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r("hbd/"),a=r("f9f4"),i=r("1w2d"),o={data:function(){return{form:{},error:{},isProcessing:!1,show:!1}},computed:{mode:function(){return this.$route.meta.mode},isEdit:function(){return"edit"===this.mode}},methods:{errors:function(t){return this.error[t]?"error-bg":""},success:function(){this.$toast({component:i.a,props:{title:"Success",icon:"BellIcon",text:this.message,variant:"success"}})},deleted:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message;this.$toast({component:i.a,props:{title:"Deleted",icon:"BellIcon",text:t,variant:"danger"}})},clearErrors:function(){this.error={}},handleError:function(t){422===t.response.status&&(this.error=t.response.data.errors)},destroy:function(t,e,r){this.clearErrors(),Object(n.a)("DELETE",t,r).then((function(t){var r=t.data;r.saved&&e(r)})).catch(this.handleError)},submit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1?arguments[1]:void 0;this.clearErrors(),"file"==t&&(this.form=Object(a.a)(this.form)),Object(n.a)(this.method,this.store,this.form).then((function(t){var r=t.data;r.saved&&e(r)})).catch(this.handleError)},submitMultipartForm:function(t,e){var r=this;this.clearErrors(),Object(n.a)(this.method,this.store,Object(a.a)(this.form)).then((function(t){var r=t.data;return!!r.saved&&(e(r),!0)})).catch((function(t){return r.handleError(t),!1}))}}}},wWPa:function(t,e,r){"use strict";var n=r("C2Uh"),a=r("hbd/"),i=r("1w2d"),o={name:"XTagInput",model:{prop:"value",event:"input"},props:{resource:String,column:String,tabindex:{default:0},positionRelative:{type:Boolean,default:!1},value:[Object,Array],disabled:{default:!1,type:Boolean},multiple:{default:!1,type:Boolean},removable:{default:!1,type:Boolean},name:{default:"value"},keyIndex:String,relation:{type:String,default:""},params:{type:[Object,Array],default:function(){return{}}}},data:function(){return{isLoading:!1,showDropdown:!1,selectIndex:-1,search:"",options:[]}},computed:{availableOptions:function(){return this.options}},methods:{removeVal:function(){this.$emit("input",{id:null})},remove:function(t,e){var r=this.value;r.splice(e,1),this.$emit("input",r)},onSearch:function(t){this.search=event.target.value,this.fetch(this.search)},fetch:Object(n.debounce)((function(t){var e=this;this.isLoading=!0;var r={q:t,column:this.column};Object(a.b)("".concat(this.resource),r).then((function(t){t.data&&e.$set(e.$data,"options",t.data.data),e.isLoading=!1}))}),300),onUpKey:function(t){var e=this;this.disabled||(this.selectIndex>0?(this.selectIndex--,this.selectIndex>4&&this.$nextTick((function(){e.$refs.items.scrollTop-=28}))):(this.selectIndex=this.options.length-1,this.$nextTick((function(){e.$refs.items.scrollTop=28*e.selectIndex}))))},onDownKey:function(t){var e=this;this.disabled||(this.showDropdown||this.open(),this.options.length-1>this.selectIndex?(this.selectIndex++,this.selectIndex>4&&this.$nextTick((function(){e.$refs.items.scrollTop+=28}))):(this.selectIndex=0,this.$nextTick((function(){e.$refs.items.scrollTop=0}))))},onKeydownMain:function(t){this.open()},select:function(t){if(this.multiple){var e=this.value;if(0===this.value.length){var r={};""==this.relation?e.push(t):(r["".concat(this.keyIndex)]=t.id,r["".concat(this.relation)]=t,e.push(r)),this.$emit("input",e)}else{for(var n=!1,a=0;a<e.length;a++)t.id===e[a][this.keyIndex]&&(this.$toast({component:i.a,props:{title:"Alert",icon:"BellIcon",text:"Option already selected above",variant:"danger"}}),n=!0);if(n)return;var o={};""==this.relation?e.push(t):(o["".concat(this.keyIndex)]=t.id,o["".concat(this.relation)]=t,e.push(o)),this.$emit("input",e)}}else this.$emit("input",t);this.close()},onEnter:function(){if(!(this.disabled||this.selectIndex<0)){var t=this.options[this.selectIndex];this.select(t)}},onBlur:function(){this.close()},onMouse:function(t){this.selectIndex=t},close:function(){this.showDropdown=!1,this.selectIndex=-1,this.search="",this.options=[]},open:function(){var t=this;this.showDropdown=!0,this.$nextTick((function(){t.$refs.search.focus(),t.options.length||t.fetch()}))},toggle:function(){this.disabled||(this.showDropdown?this.close():this.open())}}},s=r("KHd+"),c=Object(s.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"select-form"},[r("div",{ref:"toggle",staticClass:"select-input",attrs:{tabindex:t.disabled?-1:t.tabindex,disabled:t.disabled},on:{click:t.toggle,keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.onKeydownMain.apply(null,arguments))}}},[t.multiple?r("div",{staticClass:"select-text"},[t.value&&t.value.length?r("div",{staticClass:"select-tags mb-1"},t._l(t.value,(function(e,n){return r("div",{staticClass:"tag tag-primary"},[r("span",{staticClass:"tag-text"},[t._v("\n                      "+t._s(""===t.relation?e[t.name]:e[t.relation][t.name])+"\n                    ")]),t._v(" "),r("feather-icon",{attrs:{icon:"XIcon",size:"12"},on:{mousedown:function(r){return r.preventDefault(),t.remove(e,n)}}})],1)})),0):t._e()]):r("div",{staticClass:"select-text"},[t._v("\n            "+t._s(t.value&&t.value[t.name]?t.value[t.name]:"Select")+"\n        ")]),t._v(" "),t.removable&&t.value&&t.value.id?r("span",{staticClass:"select-remove icon icon-trash-a",on:{click:t.removeVal}}):r("span",{class:["select-icon icon icon-arrow-"+(t.showDropdown?"up-b":"down-b")]})]),t._v(" "),t.showDropdown?r("div",{staticClass:"select-dropdown",style:!0===t.positionRelative?"position:relative":""},[r("div",{staticClass:"select-inner"},[r("div",{staticClass:"select-search-wrap"},[r("input",{ref:"search",staticClass:"select-search",attrs:{type:"text",placeholder:"Search..."},on:{keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"down",40,e.key,["Down","ArrowDown"])?null:(e.preventDefault(),t.onDownKey.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onEnter.apply(null,arguments)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"up",38,e.key,["Up","ArrowUp"])?null:(e.preventDefault(),t.onUpKey.apply(null,arguments))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.onBlur.apply(null,arguments)}],input:t.onSearch,blur:t.onBlur}})]),t._v(" "),r("div",{ref:"items",staticClass:"select-items"},t._l(t.availableOptions,(function(e,n){return r("div",{class:["select-item",t.selectIndex===n?"select-active":""],on:{mouseover:function(e){return e.preventDefault(),t.onMouse(n)},mousedown:function(r){return r.preventDefault(),t.select(e)}}},[r("span",[t._v(t._s(e[t.name]))])])})),0)])]):t._e()])}),[],!1,null,null,null);e.a=c.exports}}]);